{% extends 'base.html' %}

{% block content %}
<section class="profile-container">
  <!-- ğŸ”¹ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ: Ñ„Ğ¾Ñ‚Ğ¾ + Ğ¸Ğ¼Ñ -->
  <div class="profile-header">
  <img src="{{ url_for('userava') }}" alt="Ğ¤Ğ¾Ñ‚Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ" class="profile-photo" />

  <div class="profile-info">
    <h2>{{ user.first_name }} {{ user.last_name }}</h2>
    <p class="profile-email">{{ user.email }}</p>
  </div>

  <div class="profile-actions">
    <a href="{{ url_for('edit_profile') }}" class="profile-btn">âš™ï¸ Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ</a>
    <a href="{{ url_for('logout') }}" class="profile-btn logout">ğŸšª Ğ’Ñ‹Ğ¹Ñ‚Ğ¸</a>
  </div>
</div>

  <!-- ğŸ”¹ Ğ‘Ğ»Ğ¾Ğº Ñ Ğ±Ğ°Ğ»Ğ»Ğ°Ğ¼Ğ¸ -->
  <div class="profile-scores">
    <div class="score-card">ğŸ•’<span>{{ statistics['today'] }}</span><small>Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ</small></div>
    <div class="score-card">ğŸ“…<span>{{ statistics['start_week'] }}</span><small>ĞĞµĞ´ĞµĞ»Ñ</small></div>
    <div class="score-card">ğŸ“†<span>{{ statistics['start_month'] }}</span><small>ĞœĞµÑÑÑ†</small></div>
    <div class="score-card">ğŸŒŸ<span>{{ statistics['all_time'] }}</span><small>Ğ’ÑĞµĞ³Ğ¾</small></div>
  </div>

  <!-- ğŸ”¹ ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° -->
  <div class="stats-summary card">
    <h3>ğŸ“Š ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°</h3>
    <ul>
      <li>âœ… Ğ’ÑĞµĞ³Ğ¾ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾ Ğ·Ğ°Ğ´Ğ°Ñ‡: <strong>{{ stats_summary.total_tasks }}</strong></li>
      <li>ğŸ“ˆ ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ·Ğ° Ğ´ĞµĞ½ÑŒ: <strong>{{ stats_summary.max_tasks_day }}</strong></li>
      <li>ğŸ”¥ Ğ”Ğ½ĞµĞ¹ Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒÑ: <strong>{{ stats_summary.active_days }}</strong></li>
    </ul>
  </div>

  <!-- ğŸ”¹ Ğ¢ĞĞŸ Ğ·Ğ°Ğ´Ğ°Ñ‡ -->
  <div class="top-tasks card">
    <h3>ğŸ”¥ Ğ¡Ğ°Ğ¼Ñ‹Ğµ Ñ‡Ğ°ÑÑ‚Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸</h3>
    <ol>
      {% for task in top_tasks %}
        <li>{{ task.icon }} {{ task.name }} â€” <strong>{{ task.summa }}</strong> Ñ€Ğ°Ğ·(Ğ°)</li>
      {% endfor %}
    </ol>
  </div>

  <!-- ğŸ”¹ Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ -->
  <div class="week-activity card">
    <h3>ğŸ—“ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ</h3>
    <div class="week-row">
      {% for day in days_activity[0] %}
        <div class="day-cell">{{ day }}</div>
      {% endfor %}
    </div>
    <div class="week-row">
      {% for active in days_activity[1] %}
        <div class="day-cell">{% if active %}âœ…{% else %}â–¢{% endif %}</div>
      {% endfor %}
    </div>
  </div>


<div class="task-history card">
  <h3>ğŸ“œ ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸</h3>

  <table class="history-table">
    <thead>
      <tr>
        <th>ğŸ“… Ğ”Ğ°Ñ‚Ğ°</th>
        <th>ğŸ“ Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°</th>
        <th>ğŸ¯ Ğ‘Ğ°Ğ»Ğ»Ñ‹</th>
        <th>ğŸ›  Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¾</th>
      </tr>
    </thead>
    <tbody>
      {% for task in history %}
      <tr>
        <td>{{ format_task_date(task.date) }}</td>
        <td>{{ task.icon or 'ğŸ“' }} {{ task.name }}</td>
        <td class="{% if task.points > 0 %}plus{% elif task.points < 0 %}minus{% endif %}">
          {{ '+' if task.points > 0 else '' }}{{ task.points }}
        </td>
        <td>
          {% if task.default_points != task.points %}
            <span class="edited">ğŸŸ¢ Ğ”Ğ°</span>
          {% else %}
            <span class="not-edited">ğŸ”´ ĞĞµÑ‚</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</section>
{% endblock %}